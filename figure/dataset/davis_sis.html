<!DOCTYPE html>
<html lang="zh-CN" style="height: 100%">

<head>
  <meta charset="utf-8">
</head>

<body style="height: 100%; margin: 0">
  <div id="container" style="height: 100%"></div>
  <script src="https://fastly.jsdelivr.net/npm/echarts@5.3.3/dist/echarts.min.js"></script>
  <script src="./davis_sis.js"></script>
  <script src="./davis_tanimoto.js"></script>
  <script src="./kiba_sis.js"></script>
  <script src="./kiba_tanimoto.js"></script>
  <script>
    let dom = document.getElementById('container');
    const myChart = echarts.init(dom, null, {
      renderer: 'canvas',
      useDirtyRect: false
    });

    const len = 20;
    const davis_sis_data = []
    const davis_tanimoto_data = []
    const kiba_sis_data = []
    const kiba_tanimoto_data = []
    for (let i = 0; i < len; i++) {
      for (let j = 0; j < len; j++) {
        davis_sis_data.push([i, len - j - 1, davis_sis_raw[i][j]]);
        davis_tanimoto_data.push([i, len - j - 1, davis_tanimoto_raw[i][j]]);
        kiba_sis_data.push([i, len - j - 1, kiba_sis_raw[i][j]]);
        kiba_tanimoto_data.push([i, len - j - 1, j, kiba_tanimoto_raw[i][j]]);
      }
    }

    xAxis = (gridIndex, name, gridId) => {
      return {
        type: 'category',
        data: Array(len),
        gridIndex,
        axisLine: { show: false },
        axisTick: { show: false },
        axisLabel: { show: false },
        show: true,
        name, 
        nameTextStyle: {
          fontWeight: 'bold', fontSize: 18,
        }, 
        nameLocation: 'middle', 
        gridId,
      }
    }

    const option = {
      toolbox: {
        show: true,
        feature: {
          dataView: { readOnly: false },
          restore: {},
          saveAsImage: {}
        }
      },
      grid: [
        { id: 'topleft', left: '7%', top:'2%', width: '40%', height: '40%' },
        { id: 'topright', right: '7%', top:'2%', width: '40%', height: '40%' },
        { id: 'bottomleft', left: '7%', bottom:'7%', width: '40%', height: '40%' },
        { id: 'bottomright', right: '7%', bottom:'7%', width: '40%', height: '40%' },
      ],
      xAxis: [
        xAxis(0, 'SIS similarity matrix of Davis', 'topleft'),
        xAxis(1, 'Tanimoto similarity matrix of Davis', 'topright'),
        xAxis(2, 'SIS similarity matrix of KIBA', 'bottomleft'),
        xAxis(3, 'Tanimoto similarity matrix of KIBA', 'bottomright'),
      ],
      yAxis: [{
        type: 'category',
        data: Array(len),
        gridIndex: 0,
        show: false,
      },{
        type: 'category',
        data: Array(len),
        gridIndex: 1,
        show: false,
      },{
        type: 'category',
        data: Array(len),
        gridIndex: 2,
        show: false,
      },{
        type: 'category',
        data: Array(len),
        gridIndex: 3,
        show: false,
      }],
      visualMap: [{
        min: 0,
        max: 1,
        calculable: true,
        seriesIndex: [0, 1, 2, 3],
        orient: 'vertical',
        left: 0,
        top: 'center',
        textStyle: {
          fontSize: 18,
        }
      }],
      series: [
        {
          type: 'heatmap',
          xAxisIndex: 0,
          yAxisIndex: 0,
          data: davis_sis_data,
        },
        {
          type: 'heatmap',
          xAxisIndex: 1,
          yAxisIndex: 1,
          data: davis_tanimoto_data,
        },
        {
          type: 'heatmap',
          xAxisIndex: 2,
          yAxisIndex: 2,
          data: kiba_sis_data,
        },
        {
          type: 'heatmap',
          xAxisIndex: 3,
          yAxisIndex: 3,
          data: kiba_tanimoto_data,
        }
      ]
    };

    myChart.setOption(option);
    window.addEventListener('resize', myChart.resize);
  </script>
</body>

</html>